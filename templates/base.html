<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}EGP Referidos{% endblock %}</title>
    <meta name="description" content="{% block meta_desc %}Programa de Referidos EGP{% endblock %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style.css">
    {% block head %}{% endblock %}
</head>

<body>
    <!-- Loading Splash Screen -->
    <div id="splash" class="splash">
        <div class="splash-content">
            <img src="/static/img/logoEGP.png" alt="EGP" class="splash-logo">
            <div class="splash-text">Cargando</div>
            <div class="splash-bar">
                <div class="splash-bar-fill"></div>
            </div>
        </div>
    </div>

    <!-- Animated Background -->
    <div class="bg-grid"></div>
    <div class="bg-gradient-orb orb-1"></div>
    <div class="bg-gradient-orb orb-2"></div>

    <!-- Navbar -->
    <nav class="navbar">
        <div class="container">
            <a href="/" class="navbar-brand">
                <span class="brand-icon"><img src="/static/img/logoEGP.png" alt="EGP"></span>
                EGP Referidos
            </a>
            <button class="nav-toggle"
                onclick="document.querySelector('.navbar-links').classList.toggle('open')">&#9776;</button>
            <ul class="navbar-links">
                <li><a href="/" {% if request.url.path=='/' %}class="active" {% endif %}>Inicio</a></li>
                <li><a href="/leaderboard" {% if request.url.path=='/leaderboard' %}class="active" {% endif
                        %}>Ranking</a></li>
                {% if user %}
                {% if user.role.value == 'REFERIDOR' %}
                <li><a href="/dashboard/referidor" {% if '/dashboard/referidor' in request.url.path %}class="active" {%
                        endif %}>Mi Panel</a></li>
                {% elif user.role.value == 'ASESOR' %}
                <li><a href="/dashboard/asesor" {% if '/dashboard/asesor' in request.url.path %}class="active" {% endif
                        %}>Mi Panel</a></li>
                {% elif user.role.value == 'ADMIN' %}
                <li><a href="/admin" {% if '/admin' in request.url.path %}class="active" {% endif %}>Admin</a></li>
                {% endif %}
                <li><a href="/auth/logout">Salir</a></li>
                {% else %}
                <li><a href="/auth/login" {% if '/auth/login' in request.url.path %}class="active" {% endif
                        %}>Ingresar</a></li>
                <li><a href="/auth/register" class="btn-nav">Registrarse</a></li>
                {% endif %}
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="page-content">
        <div class="container">
            {% block content %}{% endblock %}
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 EGP Referidos &mdash; Todos los derechos reservados</p>
        </div>
    </footer>

    <script>
        (function () {
            var splash = document.getElementById('splash');
            var navType = performance.getEntriesByType('navigation')[0];
            var isReload = navType && navType.type === 'reload';
            var shown = sessionStorage.getItem('splashShown');

            if (!shown || isReload) {
                // First visit or page refresh: show splash
                sessionStorage.setItem('splashShown', '1');
                window.addEventListener('load', function () {
                    setTimeout(function () {
                        splash.classList.add('splash-hide');
                        setTimeout(function () { splash.style.display = 'none'; }, 600);
                    }, 1400);
                });
            } else {
                // Internal navigation: hide splash immediately
                splash.style.display = 'none';
            }
        })();
    </script>
    {% block scripts %}{% endblock %}
</body>

</html>